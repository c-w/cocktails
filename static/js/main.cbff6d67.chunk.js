(this.webpackJsonpcocktails=this.webpackJsonpcocktails||[]).push([[0],{334:function(e,t,r){},335:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),i=r(46),c=r.n(i),s=r(58),o=r(15),l=r(16),u=r(19),p=r(18),h=r(21),m=r(33),d=r(120),f=r(25),g=r(50),v=r(67),b=r(180),E=r(92),w=r(182),y=r(184),S=function(e){Object(u.a)(r,e);var t=Object(p.a)(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e)).onPageChange=function(e,t){var r=t.activePage;a.setState({activePage:r})},a.state={activePage:1},a}return Object(l.a)(r,[{key:"render",value:function(){var e=this.state.activePage,t=this.props,r=t.items,a=t.itemsPerPage,i=t.className,c=Math.ceil(r.length/a),s=(e-1)*a,o=s+a,l=r.slice(s,o);return n.a.createElement("div",{className:i},n.a.createElement("div",{className:"group"},n.a.createElement(w.a.Group,{items:l})),n.a.createElement("div",{className:"pagination"},n.a.createElement(y.a,{prevItem:null,nextItem:null,firstItem:null,lastItem:null,activePage:e,onPageChange:this.onPageChange,totalPages:c})))}}]),r}(n.a.PureComponent),O=r(183),P=r(166),j=r.n(P),C=function(e){Object(u.a)(r,e);var t=Object(p.a)(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e)).onChange=function(e,t){var r=t.value;a.setState({value:r},(function(){return a._onChange(r)}))},a.state={value:e.defaultValue},a._onChange=j()(e.onChange,250),a}return Object(l.a)(r,[{key:"render",value:function(){var e=this.props,t=e.placeholder,r=e.className,a=this.state.value;return n.a.createElement("div",{className:r},n.a.createElement(O.a,{icon:"search",value:a,placeholder:t,onChange:this.onChange}))}}]),r}(n.a.Component),k=function(){function e(){Object(o.a)(this,e),this._map={}}return Object(l.a)(e,[{key:"add",value:function(e,t){this._map[e]||(this._map[e]=[]),this._map[e].push(t)}},{key:"get",value:function(e){return this._map[e]||[]}},{key:"map",value:function(e){return Object.entries(this._map).map(e)}}]),e}();var R={recipesCacheWarning:"Using cached recipes, last updated:",recipesLoadError:"Something went wrong while loading the recipes",recipesSearchPlaceholder:"Search for recipes...",recipesSortByDate:"Sort by date",recipesSortByRating:"Sort by rating",meanRatingSupport:"Cocktails",meanRatingValue:"Avg Rating",brandsSearchPlaceholder:"Search for brands...",spiritsSearchPlaceholder:"Search for spirits...",bottlesSpiritSelectPlaceholder:"Select spirit...",bottlesSpiritAllEntries:"(All)",menuEntryRecipes:"Recipes",menuEntrySpirits:"Top Spirits",menuEntryBrands:"Top brands",menuEntryBottles:"Top bottles",menuEntryAI:"AI"},x=["orange","yellow","olive","green","teal","blue","violet","purple","pink","brown"],I=function(e){var t=e.name,r=e.mean,a=e.support,i=function(e){return x[Math.abs(function(e){var t=0;if(0===e.length)return t;for(var r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return t}(e))%x.length]}(t);return{key:t,header:t,color:i,description:n.a.createElement(m.b,{to:"/recipes/".concat(t)},n.a.createElement(E.a.Group,null,n.a.createElement(E.a,{label:R.meanRatingSupport,value:a,color:i}),n.a.createElement(E.a,{label:R.meanRatingValue,value:r.toFixed(2),color:i})))}},N=function(e){Object(u.a)(r,e);var t=Object(p.a)(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e)).onSearchTextChange=function(e){a.setState({filterText:e})},a.state={filterText:e.query||""},a}return Object(l.a)(r,[{key:"render",value:function(){var e=this.props,t=e.aggregations,r=e.recipes,a=e.ratingsPerPage,i=e.searchPlaceholder,c=this.state.filterText,o=function(e){if(e.startsWith("#<")){var t=parseInt(e.substr(2),10);return function(e){return e.support<t}}if(e.startsWith("#>")){var r=parseInt(e.substr(2),10);return function(e){return e.support>r}}if(e.length>0){var a=e.toLowerCase().split("||").map((function(e){return e.trim()}));return function(e){var t=e.name;return a.some((function(e){return-1!==t.toLowerCase().indexOf(e)}))}}return function(){return!0}}(c),l=function(e,t){var r=new k;return t.forEach((function(t){return e.filter((function(e){return-1!==e.Ingredients.toLowerCase().indexOf(t.toLowerCase())})).forEach((function(e){return r.add(t,e.Rating)}))})),r.map((function(e){var t,r=Object(s.a)(e,2),a=r[0],n=r[1];return{name:a,mean:(t=n,function(e){return e.reduce((function(e,t){return e+t}),0)}(t)/t.length),support:n.length}})).sort((function(e,t){return Math.sign(t.mean-e.mean)}))}(r,t).filter(o);return n.a.createElement("div",null,n.a.createElement("div",{className:"brandControls"},i&&n.a.createElement(C,{className:"searchBar",defaultValue:c,placeholder:i,onChange:this.onSearchTextChange})),n.a.createElement(S,{className:"paginatedCardGroup",itemsPerPage:a,items:l.map(I),key:l}))}}]),r}(n.a.PureComponent);function q(e){return new RegExp("\\s(".concat(Array.from(e).join("|"),")(\\s|$)"),"i")}function W(e,t,r){var a=q(e?[e]:t),n=new Set;return r.forEach((function(e){return e.Ingredients.split("\n").filter((function(e){return null!=e.match(a)})).map((function(e){return e.replace(/\([^)]*\)/g,"")})).map((function(e){return e.replace(/^[^ ]*/,"")})).map((function(e){return e.trim()})).forEach((function(e){return n.add(e)}))})),Array.from(n).sort()}var A=function(e){Object(u.a)(r,e);var t=Object(p.a)(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e)).onSpiritChange=function(e){return a.setState({selectedSpirit:e})},a.state={selectedSpirit:e.query},a}return Object(l.a)(r,[{key:"render",value:function(){var e=this.props,t=e.words,r=e.recipes,a=e.ratingsPerPage,i=this.state.selectedSpirit;return n.a.createElement("div",null,n.a.createElement("div",{className:"bottleControls"},n.a.createElement(D,{selectedSpirit:i,spirits:t.spirits,onChange:this.onSpiritChange})),n.a.createElement(T,{spirit:i,spirits:t.spirits,recipes:r,ratingsPerPage:a}))}}]),r}(n.a.PureComponent),D=function(e){Object(u.a)(r,e);var t=Object(p.a)(r);function r(){var e;Object(o.a)(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).onChange=function(t,r){var a=r.value;return e.props.onChange(a)},e}return Object(l.a)(r,[{key:"render",value:function(){var e=this.props,t=e.spirits,r=e.selectedSpirit,a={text:R.bottlesSpiritAllEntries,value:""},i=Array.from(t).sort().map((function(e){return{text:e,value:e}})),c=[a].concat(i);return n.a.createElement(b.a,{search:!0,selection:!0,placeholder:R.bottlesSpiritSelectPlaceholder,options:c,onChange:this.onChange,defaultValue:r})}}]),r}(n.a.PureComponent),T=function(e){Object(u.a)(r,e);var t=Object(p.a)(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"render",value:function(){var e=this.props,t=e.spirit,r=e.spirits,a=e.recipes,i=e.ratingsPerPage;return n.a.createElement(N,{aggregations:W(t,r,a),recipes:a,ratingsPerPage:i})}}]),r}(n.a.PureComponent),B=function(e){Object(u.a)(r,e);var t=Object(p.a)(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"render",value:function(){var e=this.props,t=e.words,r=e.recipes,a=e.ratingsPerPage;return n.a.createElement(N,{aggregations:t.brands,searchPlaceholder:R.brandsSearchPlaceholder,recipes:r,ratingsPerPage:a})}}]),r}(n.a.PureComponent),L=r(177),U=r.n(L),_=function(e){Object(u.a)(r,e);var t=Object(p.a)(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"render",value:function(){var e=this.props.text;return n.a.createElement("div",null,function(e){var t=[];return e.split("\n").forEach((function(e,r){t.push(n.a.createElement("span",{key:"line-".concat(r)},e)),t.push(n.a.createElement("br",{key:"newline-".concat(r)}))})),t.pop(),t}(e))}}]),r}(n.a.PureComponent),z=r(121),V=r(185),G=function(e){Object(u.a)(r,e);var t=Object(p.a)(r);function r(){var e;Object(o.a)(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).onChange=function(t,r){e.props.onChange(r.value)},e}return Object(l.a)(r,[{key:"render",value:function(){var e=this,t=this.props,r=t.items,a=t.checked,i=t.className;return n.a.createElement("div",{className:i},n.a.createElement(z.a,{horizontal:!0},r.map((function(t){return n.a.createElement(z.a.Item,{key:t.value},n.a.createElement(V.a,{label:t.label,value:t.value,checked:a===t.value,onChange:e.onChange}))}))))}}]),r}(n.a.PureComponent),J=r(186),M=function(e){Object(u.a)(r,e);var t=Object(p.a)(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"render",value:function(){var e=this.props.rating;return n.a.createElement(J.a,{icon:"star",defaultRating:e,maxRating:5,disabled:!0})}}]),r}(n.a.PureComponent),$=function(e,t){return t.forEach((function(t){var r=new RegExp(t,"gi");e=e.replace(r,t.replace(/ /g,"_"))})),e},F=[{label:R.recipesSortByDate,value:"date"},{label:R.recipesSortByRating,value:"rating",comparator:function(e,t){return t.Rating-e.Rating}}],H=function(e,t){return{key:"recipe-".concat(t,"-").concat(e.Name,"-").concat(e.Ingredients),header:e.Name,description:n.a.createElement(m.b,{to:"/".concat(window.location.href.split("#")[1].split("/")[1],"/").concat(e.Name)},n.a.createElement(_,{text:(r=e.Ingredients,r.replace(/_/g," "))})),meta:n.a.createElement(M,{rating:e.Rating})};var r},K=function(e){Object(u.a)(r,e);var t=Object(p.a)(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e)).onSearchTextChange=function(e){var t=a.props.words,r=$(e,t.combined);a.setState({filterText:r})},a.onSortOrderChange=function(e){a.setState({sortOrder:e})},a.shouldShowRecipe=function(e){return function(e,t,r){if(!t)return!0;var a=$("".concat(e.Name,"\n").concat(e.Ingredients).toLowerCase(),r.combined),n=t.split("&&").map((function(e){return e.trim()})).map((function(e){return e.toLowerCase()})),i=U()(n,(function(e){return e.startsWith("!")})),c=Object(s.a)(i,2),o=c[0];return c[1].every((function(e){return-1!==a.indexOf(e)}))&&o.every((function(e){return-1===a.indexOf(e.substring(1))}))}(e,a.state.filterText,a.props.words)},a.sort=function(e){var t=a.state.sortOrder,r=F.filter((function(e){return e.value===t})).map((function(e){return e.comparator}))[0];return r&&(e=e.sort(r)),e},a.state={sortOrder:"date",filterText:e.query||""},a}return Object(l.a)(r,[{key:"render",value:function(){var e=this.props,t=e.noSort,r=e.recipes,a=e.recipesPerPage,i=this.state,c=i.filterText,s=i.sortOrder,o=this.sort(r.filter(this.shouldShowRecipe));return n.a.createElement("div",null,n.a.createElement("div",{className:"recipeControls"},n.a.createElement(C,{className:"searchBar",defaultValue:c,placeholder:R.recipesSearchPlaceholder,onChange:this.onSearchTextChange}),!t&&n.a.createElement(G,{className:"sortOrder",items:F,checked:s,onChange:this.onSortOrderChange})),n.a.createElement(S,{className:"paginatedCardGroup",itemsPerPage:a,items:o.map(H),key:o}))}}]),r}(n.a.PureComponent),Q=function(e){Object(u.a)(r,e);var t=Object(p.a)(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"render",value:function(){var e=this.props,t=e.words,r=e.recipes,a=e.ratingsPerPage;return n.a.createElement(N,{aggregations:t.spirits,searchPlaceholder:R.spiritsSearchPlaceholder,recipes:r,ratingsPerPage:a})}}]),r}(n.a.PureComponent),X="recipesCache.recipes";function Y(){var e=localStorage.getItem(X);return e?JSON.parse(e):null}function Z(e){if(e.status>=200&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t}function ee(e){return e.json()}function te(e){return fetch(e).then(Z).then(ee)}r(333),r(334);var re=function(e){Object(u.a)(r,e);var t=Object(p.a)(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e)).onRecipesLoaded=function(e,t){var r=e.recipes,n=e.aiRecipes,i=e.words;a.setState({recipes:r,aiRecipes:n,words:{combined:new Set(i.combined||[]),blacklist:new Set(i.blacklist||[]),quantity:new Set(i.quantity||[]),brands:new Set(i.brands||[]),ignored:new Set(i.ignored||[]),spirits:new Set(i.spirits||[])},cacheDate:t})},a.onStaleDataWarningDismiss=function(){a.setState({cacheDate:""})},a.renderIndex=function(e){return n.a.createElement(h.a,{to:"/recipes"})},a.renderRecipes=function(e){return n.a.createElement(K,{recipes:a.state.recipes,words:a.state.words,query:e.match.params.query,recipesPerPage:a.props.pageSize,key:e.match.params.query})},a.renderSpirits=function(e){return n.a.createElement(Q,{recipes:a.state.recipes,words:a.state.words,query:e.match.params.query,ratingsPerPage:a.props.pageSize})},a.renderBrands=function(e){return n.a.createElement(B,{recipes:a.state.recipes,words:a.state.words,query:e.match.params.query,ratingsPerPage:a.props.pageSize})},a.renderBottles=function(e){return n.a.createElement(A,{recipes:a.state.recipes,words:a.state.words,query:e.match.params.query,ratingsPerPage:a.props.pageSize})},a.renderAI=function(e){return n.a.createElement(K,{recipes:a.state.aiRecipes,words:a.state.words,query:e.match.params.query,recipesPerPage:a.props.pageSize,key:e.match.params.query,noSort:!0})},a.renderStaleDataWarning=function(e){var t=e.cacheDate;return t?n.a.createElement(v.a,{warning:!0,floating:!0,icon:!0,onDismiss:a.onStaleDataWarningDismiss,className:"messageTop"},n.a.createElement(f.a,{name:"plug"}),n.a.createElement(v.a.Content,null,n.a.createElement(v.a.Header,null,R.recipesLoadError),R.recipesCacheWarning," ",t)):null},a.renderNav=function(e){var t=e.location.pathname;return n.a.createElement(g.a,{icon:"labeled",size:"mini",fixed:"bottom"},n.a.createElement(g.a.Item,{as:m.b,to:"/recipes",active:t.startsWith("/recipes")},n.a.createElement(f.a,{name:"cocktail"}),R.menuEntryRecipes),n.a.createElement(g.a.Item,{as:m.b,to:"/spirits",active:t.startsWith("/spirits")},n.a.createElement(f.a,{name:"bar chart"}),R.menuEntrySpirits),n.a.createElement(g.a.Item,{as:m.b,to:"/brands",active:t.startsWith("/brands")},n.a.createElement(f.a,{name:"line chart"}),R.menuEntryBrands),n.a.createElement(g.a.Item,{as:m.b,to:"/bottles",active:t.startsWith("/bottles")},n.a.createElement(f.a,{name:"winner"}),R.menuEntryBottles),n.a.createElement(g.a.Item,{as:m.b,to:"/ai",active:t.startsWith("/ai")},n.a.createElement(f.a,{name:"flask"}),R.menuEntryAI))},a.state={error:null,recipes:[],aiRecipes:[],words:{},cacheDate:""},a}return Object(l.a)(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.recipesUrl,a=t.aiRecipesUrl,n=t.wordsUrl;Promise.all([te(r),te(a),te(n)]).then((function(t){var r=Object(s.a)(t,3),a=r[0],n=r[1],i=r[2];e.onRecipesLoaded({recipes:a,aiRecipes:n,words:i}),function(e){var t,r,a,n=Y();(null===n||void 0===n||null===(t=n.recipes)||void 0===t?void 0:t.length)===e.recipes.length&&(null===n||void 0===n||null===(r=n.aiRecipes)||void 0===r?void 0:r.length)===e.aiRecipes.length&&(null===n||void 0===n||null===(a=n.words)||void 0===a?void 0:a.length)===e.words.length||localStorage.setItem(X,JSON.stringify({recipes:e.recipes,aiRecipes:e.aiRecipes,words:e.words,cacheDate:(new Date).toString()}))}({recipes:a,aiRecipes:n,words:i})})).catch((function(t){var r=Y();if(r){var a=r.recipes,n=r.aiRecipes,i=r.words,c=r.cacheDate;e.onRecipesLoaded({recipes:a,aiRecipes:n,words:i},c)}else e.setState({error:t})}))}},{key:"render",value:function(){var e=this.state,t=e.error,r=e.recipes,a=e.cacheDate;return t?n.a.createElement(d.a,null,n.a.createElement(v.a,{error:!0,content:R.recipesLoadError,className:"messageTop"})):0===r.length?null:n.a.createElement(m.a,null,n.a.createElement(d.a,null,this.renderStaleDataWarning({cacheDate:a}),n.a.createElement(h.b,{path:"*",component:this.renderNav}),n.a.createElement(h.d,null,n.a.createElement(h.b,{exact:!0,path:"/",component:this.renderIndex}),n.a.createElement(h.b,{exact:!0,path:"/recipes/:query?",render:this.renderRecipes}),n.a.createElement(h.b,{exact:!0,path:"/spirits/:query?",render:this.renderSpirits}),n.a.createElement(h.b,{exact:!0,path:"/brands/:query?",render:this.renderBrands}),n.a.createElement(h.b,{exact:!0,path:"/bottles/:query?",render:this.renderBottles}),n.a.createElement(h.b,{exact:!0,path:"/ai/:query?",render:this.renderAI}))))}}]),r}(n.a.Component),ae=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ne(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var r=e.installing;null!=r&&(r.onstatechange=function(){"installed"===r.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}c.a.render(n.a.createElement(re,{recipesUrl:"https://raw.githubusercontent.com/c-w/cocktails/master/recipes.json",aiRecipesUrl:"https://raw.githubusercontent.com/c-w/cocktails/master/lstm-recipes.json",wordsUrl:"https://raw.githubusercontent.com/c-w/cocktails/master/words.json",pageSize:parseInt("6",10)}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/cocktails",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/cocktails","/service-worker.js");ae?(!function(e,t){fetch(e).then((function(r){var a=r.headers.get("content-type");404===r.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ne(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")}))):ne(t,e)}))}}()}},[[335,1,2]]]);
//# sourceMappingURL=main.cbff6d67.chunk.js.map