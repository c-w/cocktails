(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{298:function(e,t,r){e.exports=r(535)},533:function(e,t,r){},535:function(e,t,r){"use strict";r.r(t);var a=r(1),n=r.n(a),c=r(65),i=r.n(c),o=r(54),s=r(11),l=r(12),u=r(15),p=r(14),m=r(16),h=r(264),f=r.n(h),d=r(67),g=r.n(d),b=r(265),v=r.n(b),O=r(68),E=r.n(O),y=r(266),j=r.n(y),w=r(183),S=r(23),P=r(55),C=r(92),k=r(292),x=r(134),T=r(293),N=r(295),I=function(e){function t(e){var r;return Object(s.a)(this,t),(r=Object(u.a)(this,Object(p.a)(t).call(this,e))).onPageChange=function(e,t){var a=t.activePage;r.setState({activePage:a})},r.state={activePage:1},r}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(){this.setState({activePage:1})}},{key:"render",value:function(){var e=this.state.activePage,t=this.props,r=t.items,a=t.itemsPerPage,c=t.className,i=Math.ceil(r.length/a),o=(e-1)*a,s=o+a,l=r.slice(o,s);return n.a.createElement("div",{className:c},n.a.createElement("div",{className:"group"},n.a.createElement(T.a.Group,{items:l})),n.a.createElement("div",{className:"pagination"},n.a.createElement(N.a,{prevItem:null,nextItem:null,firstItem:null,lastItem:null,activePage:e,onPageChange:this.onPageChange,totalPages:i})))}}]),t}(n.a.PureComponent),R=r(294),D=function(e){function t(){var e,r;Object(s.a)(this,t);for(var a=arguments.length,n=new Array(a),c=0;c<a;c++)n[c]=arguments[c];return(r=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).onChange=function(e,t){r.props.onChange(t.value)},r}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.placeholder,r=e.defaultValue,a=e.className;return n.a.createElement("div",{className:a},n.a.createElement(R.a,{icon:"search",defaultValue:r,placeholder:t,onChange:this.onChange}))}}]),t}(n.a.Component),q=function(){function e(){Object(s.a)(this,e),this._map={}}return Object(l.a)(e,[{key:"add",value:function(e,t){this._map[e]||(this._map[e]=[]),this._map[e].push(t)}},{key:"get",value:function(e){return this._map[e]||[]}},{key:"map",value:function(e){return Object.entries(this._map).map(e)}}]),e}();var B={recipesCacheWarning:"Using cached recipes, last updated:",recipesLoadError:"Something went wrong while loading the recipes",recipesSearchPlaceholder:"Search for recipes...",recipesSortByDate:"Sort by date",recipesSortByRating:"Sort by rating",meanRatingSupport:"Cocktails",meanRatingValue:"Avg Rating",brandsSearchPlaceholder:"Search for brands...",spiritsSearchPlaceholder:"Search for spirits...",bottlesSpiritSelectPlaceholder:"Select spirit...",menuEntryRecipes:"Recipes",menuEntrySpirits:"Top Spirits",menuEntryBrands:"Top brands",menuEntryBottles:"Top bottles"},L=["orange","yellow","olive","green","teal","blue","violet","purple","pink","brown"],W=function(e){var t=e.name,r=e.mean,a=e.support,c=function(e){return L[Math.abs(function(e){var t=0;if(0===e.length)return t;for(var r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return t}(e))%L.length]}(t);return{key:t,header:t,color:c,description:n.a.createElement(g.a,{to:"/recipes/".concat(t)},n.a.createElement(x.a.Group,null,n.a.createElement(x.a,{label:B.meanRatingSupport,value:a,color:c}),n.a.createElement(x.a,{label:B.meanRatingValue,value:r.toFixed(2),color:c})))}},_=function(e){function t(e){var r;return Object(s.a)(this,t),(r=Object(u.a)(this,Object(p.a)(t).call(this,e))).onSearchTextChange=function(e){r.setState({filterText:e})},r.state={filterText:e.query||""},r}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.aggregations,r=e.recipes,a=e.ratingsPerPage,c=e.searchPlaceholder,i=this.state.filterText,s=function(e){if(e.startsWith("#<")){var t=parseInt(e.substr(2),10);return function(e){return e.support<t}}if(e.startsWith("#>")){var r=parseInt(e.substr(2),10);return function(e){return e.support>r}}if(e.length>0){var a=e.toLowerCase().split("||").map(function(e){return e.trim()});return function(e){var t=e.name;return a.some(function(e){return-1!==t.toLowerCase().indexOf(e)})}}return function(){return!0}}(i),l=function(e,t){var r=new q;return t.forEach(function(t){return e.filter(function(e){return-1!==e.Ingredients.toLowerCase().indexOf(t.toLowerCase())}).forEach(function(e){return r.add(t,e.Rating)})}),r.map(function(e){var t,r=Object(o.a)(e,2),a=r[0],n=r[1];return{name:a,mean:(t=n,function(e){return e.reduce(function(e,t){return e+t},0)}(t)/t.length),support:n.length}}).sort(function(e,t){return Math.sign(t.mean-e.mean)})}(r,t).filter(s);return n.a.createElement("div",null,n.a.createElement("div",{className:"brandControls"},c&&n.a.createElement(D,{className:"searchBar",defaultValue:i,placeholder:c,onChange:this.onSearchTextChange})),n.a.createElement(I,{className:"paginatedCardGroup",itemsPerPage:a,items:l.map(W)}))}}]),t}(n.a.PureComponent);var z=function(e){function t(e){var r;return Object(s.a)(this,t),(r=Object(u.a)(this,Object(p.a)(t).call(this,e))).onSpiritChange=function(e){return r.setState({selectedSpirit:e})},r.state={selectedSpirit:e.query},r}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.words,r=e.recipes,a=e.ratingsPerPage,c=this.state.selectedSpirit;return n.a.createElement("div",null,n.a.createElement("div",{className:"bottleControls"},n.a.createElement(A,{selectedSpirit:c,spirits:t.spirits,onChange:this.onSpiritChange})),n.a.createElement(V,{spirit:c,recipes:r,ratingsPerPage:a}))}}]),t}(n.a.PureComponent),A=function(e){function t(){var e,r;Object(s.a)(this,t);for(var a=arguments.length,n=new Array(a),c=0;c<a;c++)n[c]=arguments[c];return(r=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).onChange=function(e,t){var a=t.value;return r.props.onChange(a)},r}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.spirits,r=e.selectedSpirit,a=Array.from(t).sort().map(function(e){return{text:e,value:e}});return n.a.createElement(k.a,{search:!0,selection:!0,placeholder:B.bottlesSpiritSelectPlaceholder,options:a,onChange:this.onChange,defaultValue:r})}}]),t}(n.a.PureComponent),V=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.spirit,r=e.recipes,a=e.ratingsPerPage;return t?n.a.createElement(_,{aggregations:function(e,t){var r=new RegExp("\\s".concat(e,"(\\s|$)"),"i"),a=new Set;return t.forEach(function(e){return e.Ingredients.split("\n").filter(function(e){return null!=e.match(r)}).map(function(e){return e.replace(/\([^)]*\)/g,"")}).map(function(e){return e.replace(/^[^ ]*/,"")}).map(function(e){return e.trim()}).forEach(function(e){return a.add(e)})}),Array.from(a).sort()}(t,r),recipes:r,ratingsPerPage:a}):null}}]),t}(n.a.PureComponent),F=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.words,r=e.recipes,a=e.ratingsPerPage;return n.a.createElement(_,{aggregations:t.brands,searchPlaceholder:B.brandsSearchPlaceholder,recipes:r,ratingsPerPage:a})}}]),t}(n.a.PureComponent),J=r(133),U=r(124),G=r(81),M=function(e){function t(){var e,r;Object(s.a)(this,t);for(var a=arguments.length,n=new Array(a),c=0;c<a;c++)n[c]=arguments[c];return(r=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).onToggle=function(e,t){r.props.onToggle(t.label)},r}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props,r=t.items,a=t.className;return n.a.createElement("div",{className:a},n.a.createElement(G.a,{horizontal:!0},r.map(function(t){return n.a.createElement(G.a.Item,{key:t.label},n.a.createElement(U.a,{label:t.label,checked:t.checked,onChange:e.onToggle}))})))}}]),t}(n.a.PureComponent),$=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.text;return n.a.createElement("div",null,function(e){var t=[];return e.split("\n").forEach(function(e,r){t.push(n.a.createElement("span",{key:"line-".concat(r)},e)),t.push(n.a.createElement("br",{key:"newline-".concat(r)}))}),t.pop(),t}(e))}}]),t}(n.a.PureComponent),H=r(296),Z=function(e){function t(){var e,r;Object(s.a)(this,t);for(var a=arguments.length,n=new Array(a),c=0;c<a;c++)n[c]=arguments[c];return(r=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).onChange=function(e,t){r.props.onChange(t.value)},r}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props,r=t.items,a=t.checked,c=t.className;return n.a.createElement("div",{className:c},n.a.createElement(G.a,{horizontal:!0},r.map(function(t){return n.a.createElement(G.a.Item,{key:t.value},n.a.createElement(H.a,{label:t.label,value:t.value,checked:a===t.value,onChange:e.onChange}))})))}}]),t}(n.a.PureComponent),K=r(297),Q=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.rating;return n.a.createElement(K.a,{icon:"star",defaultRating:e,maxRating:5,disabled:!0})}}]),t}(n.a.PureComponent),X=function(e){var t={};return e.forEach(function(e){t[e]?t[e]++:t[e]=1}),t},Y=function(){function e(t){Object(s.a)(this,e),this._counter=X(t)}return Object(l.a)(e,[{key:"mostCommon",value:function(e){return Object.entries(this._counter).sort(function(e,t){var r=Object(o.a)(e,2),a=(r[0],r[1]),n=Object(o.a)(t,2);n[0];return n[1]-a}).map(function(e){var t=Object(o.a)(e,2),r=t[0];t[1];return r}).slice(0,e)}}]),e}(),ee="recipesCache";var te,re,ae=function(e,t){var r=!0,a=!1,n=void 0;try{for(var c,i=t[Symbol.iterator]();!(r=(c=i.next()).done);r=!0){var o=c.value,s=new RegExp(o,"gi");e=e.replace(s,o.replace(/ /g,"_"))}}catch(l){a=!0,n=l}finally{try{r||null==i.return||i.return()}finally{if(a)throw n}}return e},ne=function(e){return e.replace(/_/g," ")},ce=function(e,t){var r=!0,a=!1,n=void 0;try{for(var c,i=t[Symbol.iterator]();!(r=(c=i.next()).done);r=!0){var o=c.value;if(-1!==e.indexOf(o))return!0}}catch(s){a=!0,n=s}finally{try{r||null==i.return||i.return()}finally{if(a)throw n}}return!1},ie=(te=function(e){var t=e.recipes,r=e.numFilters,a=e.words,n=new Set(Object(J.a)(a.combined).concat(Object(J.a)(a.brands),Object(J.a)(a.spirits))),c=[];return t.map(function(e){return e.Ingredients}).forEach(function(e){e.split("\n").filter(function(e){return!ce(e,a.blacklist)}).forEach(function(e){ae(e,n).split(" ").map(function(e){return e.replace(/\([^)]*\)/g,"")}).map(function(e){return ne(e)}).map(function(e){return e.replace(/[^a-zA-Z ]/g,"")}).filter(function(e){return e.length>0}).map(function(e){return e.toLowerCase()}).filter(function(e){return!ce(e,a.quantity)}).filter(function(e){return!ce(e,a.ignored)}).forEach(function(e){return c.push(e)})})}),new Y(c).mostCommon(r).map(function(e){return{term:e,enabled:!1}})},re="getFilterTerms",function(e){var t="".concat(ee,".").concat(e.recipes.length,".").concat(re),r=localStorage.getItem(t);if(null!=r)return JSON.parse(r);var a=te(e);return localStorage.setItem(t,JSON.stringify(a)),a}),oe=function(e,t){if(!t.length)return!0;var r=ne(e.Ingredients).toLowerCase();return t.filter(function(e){return e.enabled}).map(function(e){return e.term.toLowerCase()}).every(function(e){return-1!==r.indexOf(e)})},se=function(e,t,r){if(!t)return!0;var a=ae("".concat(e.Name,"\n").concat(e.Ingredients).toLowerCase(),r.combined);return t.split("&&").map(function(e){return e.trim()}).map(function(e){return e.toLowerCase()}).every(function(e){return-1!==a.indexOf(e)})},le=[{label:B.recipesSortByDate,value:"date"},{label:B.recipesSortByRating,value:"rating",comparator:function(e,t){return t.Rating-e.Rating}}],ue=function(e,t){return{key:"recipe-".concat(t,"-").concat(e.Name,"-").concat(e.Ingredients),header:e.Name,description:n.a.createElement($,{text:ne(e.Ingredients)}),meta:n.a.createElement(Q,{rating:e.Rating})}},pe=function(e){return{label:e.term,checked:e.enabled}},me=function(e){function t(e){var r;return Object(s.a)(this,t),(r=Object(u.a)(this,Object(p.a)(t).call(this,e))).onSearchTermToggle=function(e){var t=r.state.filterTerms.map(function(t){var r=t.term,a=t.enabled;return r===e?{term:r,enabled:!a}:{term:r,enabled:a}});r.setState({filterTerms:t})},r.onSearchTextChange=function(e){var t=r.props.words,a=ae(e,t.combined);r.setState({filterText:a})},r.onSortOrderChange=function(e){r.setState({sortOrder:e})},r.shouldShowRecipe=function(e){var t=r.state,a=t.filterTerms,n=t.filterText,c=r.props.words;return oe(e,a)&&se(e,n,c)},r.sort=function(e){var t=r.state.sortOrder,a=le.filter(function(e){return e.value===t}).map(function(e){return e.comparator})[0];return a&&(e=e.sort(a)),e},r.state={sortOrder:"date",filterText:e.query||"",filterTerms:ie(e)},r}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.recipes,r=e.recipesPerPage,a=this.state,c=a.filterTerms,i=a.filterText,o=a.sortOrder,s=this.sort(t.filter(this.shouldShowRecipe));return n.a.createElement("div",null,n.a.createElement("div",{className:"recipeControls"},n.a.createElement(M,{className:"filters",items:c.map(pe),onToggle:this.onSearchTermToggle}),n.a.createElement(D,{className:"searchBar",defaultValue:i,placeholder:B.recipesSearchPlaceholder,onChange:this.onSearchTextChange}),n.a.createElement(Z,{className:"sortOrder",items:le,checked:o,onChange:this.onSortOrderChange})),n.a.createElement(I,{className:"paginatedCardGroup",itemsPerPage:r,items:s.map(ue)}))}}]),t}(n.a.PureComponent),he=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.words,r=e.recipes,a=e.ratingsPerPage;return n.a.createElement(_,{aggregations:t.spirits,searchPlaceholder:B.spiritsSearchPlaceholder,recipes:r,ratingsPerPage:a})}}]),t}(n.a.PureComponent);function fe(e){if(e.status>=200&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t}function de(e){return e.json()}function ge(e){return fetch(e).then(fe).then(de)}r(530),r(533);var be=function(e){function t(e){var r;return Object(s.a)(this,t),(r=Object(u.a)(this,Object(p.a)(t).call(this,e))).onRecipesLoaded=function(e,t){var a=e.recipes,n=e.words;r.setState({recipes:a,words:{combined:new Set(n.combined||[]),blacklist:new Set(n.blacklist||[]),quantity:new Set(n.quantity||[]),brands:new Set(n.brands||[]),ignored:new Set(n.ignored||[]),spirits:new Set(n.spirits||[])},cacheDate:t})},r.onStaleDataWarningDismiss=function(){r.setState({cacheDate:""})},r.renderIndex=function(e){return n.a.createElement(v.a,{to:"/recipes"})},r.renderRecipes=function(e){return n.a.createElement(me,{recipes:r.state.recipes,words:r.state.words,query:e.match.params.query,recipesPerPage:r.props.pageSize,numFilters:r.props.numFilters})},r.renderSpirits=function(e){return n.a.createElement(he,{recipes:r.state.recipes,words:r.state.words,query:e.match.params.query,ratingsPerPage:r.props.pageSize})},r.renderBrands=function(e){return n.a.createElement(F,{recipes:r.state.recipes,words:r.state.words,query:e.match.params.query,ratingsPerPage:r.props.pageSize})},r.renderBottles=function(e){return n.a.createElement(z,{recipes:r.state.recipes,words:r.state.words,query:e.match.params.query,ratingsPerPage:r.props.pageSize})},r.renderStaleDataWarning=function(e){var t=e.cacheDate;return t?n.a.createElement(C.a,{warning:!0,floating:!0,icon:!0,onDismiss:r.onStaleDataWarningDismiss,className:"messageTop"},n.a.createElement(S.a,{name:"plug"}),n.a.createElement(C.a.Content,null,n.a.createElement(C.a.Header,null,B.recipesLoadError),B.recipesCacheWarning," ",t)):null},r.renderNav=function(e){var t=e.location.pathname;return n.a.createElement(P.a,{icon:"labeled",size:"mini",fixed:"bottom"},n.a.createElement(P.a.Item,{as:g.a,to:"/recipes",active:t.startsWith("/recipes")},n.a.createElement(S.a,{name:"cocktail"}),B.menuEntryRecipes),n.a.createElement(P.a.Item,{as:g.a,to:"/spirits",active:t.startsWith("/spirits")},n.a.createElement(S.a,{name:"bar chart"}),B.menuEntrySpirits),n.a.createElement(P.a.Item,{as:g.a,to:"/brands",active:t.startsWith("/brands")},n.a.createElement(S.a,{name:"line chart"}),B.menuEntryBrands),n.a.createElement(P.a.Item,{as:g.a,to:"/bottles",active:t.startsWith("/bottles")},n.a.createElement(S.a,{name:"winner"}),B.menuEntryBottles))},r.state={error:null,recipes:[],words:{},cacheDate:""},r}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.recipesUrl,a=t.wordsUrl;Promise.all([ge(r),ge(a)]).then(function(t){var r=Object(o.a)(t,2),a=r[0],n=r[1];e.onRecipesLoaded({recipes:a,words:n}),function(e){var t=e.recipes,r=e.words;window.localStorage.setItem(ee,JSON.stringify({recipes:t,words:r,cacheDate:(new Date).toString()}))}({recipes:a,words:n})}).catch(function(t){var r=function(){var e=window.localStorage.getItem(ee);return e?JSON.parse(e):null}();if(r){var a=r.recipes,n=r.words,c=r.cacheDate;e.onRecipesLoaded({recipes:a,words:n},c)}else e.setState({error:t})})}},{key:"render",value:function(){var e=this.state,t=e.error,r=e.recipes,a=e.cacheDate;return t?n.a.createElement(w.a,null,n.a.createElement(C.a,{error:!0,content:B.recipesLoadError,className:"messageTop"})):0===r.length?null:n.a.createElement(f.a,null,n.a.createElement(w.a,null,this.renderStaleDataWarning({cacheDate:a}),n.a.createElement(E.a,{path:"*",component:this.renderNav}),n.a.createElement(j.a,null,n.a.createElement(E.a,{exact:!0,path:"/",component:this.renderIndex}),n.a.createElement(E.a,{exact:!0,path:"/recipes/:query?",render:this.renderRecipes}),n.a.createElement(E.a,{exact:!0,path:"/spirits/:query?",render:this.renderSpirits}),n.a.createElement(E.a,{exact:!0,path:"/brands/:query?",render:this.renderBrands}),n.a.createElement(E.a,{exact:!0,path:"/bottles/:query?",render:this.renderBottles}))))}}]),t}(n.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(n.a.createElement(be,{recipesUrl:"https://raw.githubusercontent.com/c-w/cocktails-blog/master/recipes.json",wordsUrl:"https://raw.githubusercontent.com/c-w/cocktails-blog/master/words.json",pageSize:parseInt("6",10),numFilters:parseInt("10",10)}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[298,2,1]]]);
//# sourceMappingURL=main.b48af0ef.chunk.js.map